<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Query and set git credentials — gitcreds_get • gitcreds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Query and set git credentials — gitcreds_get"><meta name="description" content="This manual page is for users of packages that depend on gitcreds
for managing tokens or passwords to GitHub or other git repositories.
If you are a package author and want to import gitcreds for this
functionality, see vignette(&quot;package&quot;, package = &quot;gitcreds&quot;).
Otherwise please start at 'Basics' below."><meta property="og:description" content="This manual page is for users of packages that depend on gitcreds
for managing tokens or passwords to GitHub or other git repositories.
If you are a package author and want to import gitcreds for this
functionality, see vignette(&quot;package&quot;, package = &quot;gitcreds&quot;).
Otherwise please start at 'Basics' below."><meta name="robots" content="noindex"><script defer data-domain="gitcreds.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gitcreds</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/package.html">For package authors</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/gitcreds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Query and set git credentials</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/gitcreds/blob/main/R/aaa-doc.R" class="external-link"><code>R/aaa-doc.R</code></a></small>
      <div class="d-none name"><code>gitcreds_get.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This manual page is for <em>users</em> of packages that depend on gitcreds
for managing tokens or passwords to GitHub or other git repositories.
If you are a package author and want to import gitcreds for this
functionality, see <code><a href="../articles/package.html">vignette("package", package = "gitcreds")</a></code>.
Otherwise please start at 'Basics' below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gitcreds_get</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com"</span>, use_cache <span class="op">=</span> <span class="cn">TRUE</span>, set_cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gitcreds_set</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gitcreds_delete</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gitcreds_list_helpers</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>URL to get, set or delete credentials for. It may contain a
user name, which is typically (but not always) used by the credential
helpers. It may also contain a path, which is typically (but not always)
ignored by the credential helpers.</p></dd>


<dt id="arg-use-cache">use_cache<a class="anchor" aria-label="anchor" href="#arg-use-cache"></a></dt>
<dd><p>Whether to try to use the environment variable cache
before turning to git to look up the credentials for <code>url</code>.
See <code><a href="gitcreds_cache_envvar.html">gitcreds_cache_envvar()</a></code>.</p></dd>


<dt id="arg-set-cache">set_cache<a class="anchor" aria-label="anchor" href="#arg-set-cache"></a></dt>
<dd><p>Whether to set the environment variable cache after
receiving the credentials from git. See <code><a href="gitcreds_cache_envvar.html">gitcreds_cache_envvar()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>gitcreds_get()</code> returns a <code>gitcreds</code> object, a named list
of strings, the fields returned by the git credential handler.
Typically the fields are <code>protocol</code>, <code>host</code>, <code>username</code>, <code>password</code>.
Some credential helpers support path-dependent credentials and also
return a <code>path</code> field.</p>
<p><code>gitcreds_set()</code> returns nothing.</p>
<p><code>gitcreds_delete()</code> returns <code>FALSE</code> if it did not find find any
credentials to delete, and thus it did not call <code>git credential reject</code>.
Otherwise it returns <code>TRUE</code>.</p>
<p><code>gitcreds_get()</code> errors if git is not installed, no credential helpers
are configured or no credentials are found. <code>gitcreds_set()</code> errors if
git is not installed, or setting the new credentials fails.
<code>gitcreds_delete()</code> errors if git is not installed or the git calls fail.
See <code><a href="../articles/package.html">vignette("package", package = "gitcreds")</a></code> if you want to handle
these errors.</p>
<p><code>gitcreds_list_helpers()</code> returns a character vector,
corresponding to the <code>credential.helper</code> git configuration key.
Usually it contains a single credential helper, but it is possible to
configure multiple helpers.</p>
    </div>
    <div class="section level2">
    <h2 id="basics">Basics<a class="anchor" aria-label="anchor" href="#basics"></a></h2>
    <p><code>gitcreds_get()</code> queries git credentials. It is typically used by package
code that needs to authenticate to GitHub or another git repository.
The end user might call <code>gitcreds_get()</code> directly to check that the
credentials are properly set up.</p>
<p><code>gitcreds_set()</code> adds or updates git credentials in the credential store.
It is typically called by the user, and it only works in interactive
sessions. It always asks for acknowledgement before it overwrites
existing credentials.</p>
<p><code>gitcreds_delete()</code> deletes git credentials from the credential store.
It is typically called by the user, and it only works in interactive
sessions. It always asks for acknowledgement.</p>
<p><code>gitcreds_list_helpers()</code> lists the active credential helpers.</p><div class="section">
<h3 id="git-versions">git versions<a class="anchor" aria-label="anchor" href="#git-versions"></a></h3>


<p>These functions use the <code>git credential</code> system command to query and set
git credentials. They need an external git installation. You can
download git from https://git-scm.com/downloads. A recent version is
best, but at least git 2.9 is suggested.</p>
<p>gitcreds should work out of the box on macOS with git versions 2.9.2
or later, and on Windows with git versions 2.12.1 or later, using the
default git settings. On Windows, for git versions from 2.9.2 up until
2.12.1 you probably need to set the default credential helper to
<code>wincred</code>. It is usually simpler to update git to a recent version.</p>
<p>To see your current git version run <code>git --version</code> from your shell.
Or from R:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"git --version"</span><span class="op">)</span></span></code></pre><p></p></div>
<p>If you need to avoid installing git, see 'Environment variables' below.</p>
</div>

<div class="section">
<h3 id="github">GitHub<a class="anchor" aria-label="anchor" href="#github"></a></h3>

<div class="section">
<h4 id="new-setup">New setup<a class="anchor" aria-label="anchor" href="#new-setup"></a></h4>


<p>To set up password-less authentication to GitHub:</p><ol><li><p>Create a personal access token (PAT). See
<a href="https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token" class="external-link">https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token</a>.
Note that personal access tokens can expire, and the default expiration time is 30 days.</p></li>
<li><p>Call <code>gitcreds_set()</code> and give this token as the password.</p></li>
<li><p>Run <code>gitcreds_get(use_cache = FALSE)</code> to check that the new
PAT is set up. To see the token, you can run
<code>gitcreds_get(use_cache = FALSE)$password</code>.</p></li>
</ol></div>

<div class="section">
<h4 id="migrating-from-the-github-pat-environment-variable">Migrating from the <code>GITHUB_PAT</code> environment variable<a class="anchor" aria-label="anchor" href="#migrating-from-the-github-pat-environment-variable"></a></h4>


<p>If you already have a GitHub token, and use the <code>GITHUB_PAT</code> or
<code>GITHUB_TOKEN</code> environment variable in your <code>.Renviron</code> file or
elsewhere, no changes are neccessary. gitcreds will automatically use
this variable.</p>
<p>However, we still suggest that you add your token to the git credential
store with <code>gitcreds_set()</code> and remove <code>GITHUB_PAT</code> from your
<code>.Renviron</code> file. The credential store is more secure than storing
tokens in files, and command line git also uses the credential store
for password-less authentication.</p>
</div>


</div>

    </div>
    <div class="section level2">
    <h2 id="advanced-topics">Advanced topics<a class="anchor" aria-label="anchor" href="#advanced-topics"></a></h2>

<div class="section">
<h3 id="cached-credentials">Cached credentials<a class="anchor" aria-label="anchor" href="#cached-credentials"></a></h3>


<p>Because querying the git credential store might not be very fast,
<code>gitcreds_get()</code> caches credentials in environment variables by default.
Credentials for different URLs are stored in different environment
variables. The name of the environment variable is calculated with
<code><a href="gitcreds_cache_envvar.html">gitcreds_cache_envvar()</a></code>.</p>
<p>To remove the cache, remove this environment variable with
<code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.unsetenv()</a></code>.</p>
</div>

<div class="section">
<h3 id="environment-variables">Environment variables<a class="anchor" aria-label="anchor" href="#environment-variables"></a></h3>


<p>If you want to avoid installing git, or using the credential store for
some reason, you can supply credentials in environment variables, e.g.
via the <code>.Renviron</code> file. Use <code><a href="gitcreds_cache_envvar.html">gitcreds_cache_envvar()</a></code> to query the
environment variable you need to set for a URL:</p><ol><li><p>You can set this environment variable to the token or password itself.</p></li>
<li><p>If you also need a user name, then use the <code>user:password</code> form, i.e.
separate them with a colon. (If your user name or passwrd has <code>:</code>
characters, then you need to escape them with a preceding backslash.)</p></li>
</ol></div>

<div class="section">
<h3 id="proxies">Proxies<a class="anchor" aria-label="anchor" href="#proxies"></a></h3>


<p>git should pick up the proxy configuration from the <code>http_proxy</code>,
<code>https_proxy</code>, and <code>all_proxy</code> environment variables. To override
these, you can set the <code>http.proxy</code> git configuration key.
More info here: https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpproxy
and here: https://github.com/microsoft/Git-Credential-Manager-Core/blob/master/docs/netconfig.md</p>
</div>

<div class="section">
<h3 id="credential-helpers">Credential helpers<a class="anchor" aria-label="anchor" href="#credential-helpers"></a></h3>


<p>git credential helpers are an extensible, configurable mechanism to
store credentials. Different git installations have different credentials
helpers. On Windows the default helper stores credentials in the system
credential store. On macOS, it stores them in the macOS Keychain.
Other helpers cache credentials in a server process or in a file on the
file system.</p>
<p>gitcreds only works if a credential helper is configured. For the current
git version (2.29.0), this is the case by default on Windows and macOS
(for git from HomeBrew), but most Linux distributions do not set up a
default credential helper.</p>
<p>You can use <code>gitcreds_list_helpers()</code> to see the <em>active</em> credential
helper(s) for a repository. Make sure you set the working directory
to the git tree before calling <code>gitcreds_list_helpers()</code>.</p>
</div>

<div class="section">
<h3 id="the-current-working-directory">The current working directory<a class="anchor" aria-label="anchor" href="#the-current-working-directory"></a></h3>


<p>git allows repository specific configuration, via the <code>.git/config</code> file.
The <code>config</code> file might specify a different credential helper, a
different user name, etc. This means that <code>gitcreds_get()</code> etc. will
potentially work differently depending on the current working
directory. This is especially relevant for package code that changes
the working directory temporarily.</p>
</div>

<div class="section">
<h3 id="non-github-accounts">Non-GitHub accounts<a class="anchor" aria-label="anchor" href="#non-github-accounts"></a></h3>


<p>Non-GitHub URLs work mostly the same way as GitHub URLs.
<code>gitcreds_get()</code> and <code>gitcreds_set()</code> default to GitHub, so you'll need
to explicitly set their <code>url</code> argument.</p>
<p>Some credential helpers, e.g. Git Credential Manager for Windows
(<code>manager</code>) and Git Credential Manager Core (<code>manager-core</code>) work
slightly differently for GitHub and non-GitHub URLs, see their
documentation for details.</p>
</div>

<div class="section">
<h3 id="multiple-accounts">Multiple accounts<a class="anchor" aria-label="anchor" href="#multiple-accounts"></a></h3>


<p>The various credential helpers support having multiple accounts on the
same server in different ways. Here are our recommendations.</p><div class="section">
<h4 id="macos">macOS<a class="anchor" aria-label="anchor" href="#macos"></a></h4>

<ol><li><p>Use the (currently default) <code>osxkeychain</code> credential helper.</p></li>
<li><p>In Keychain Access, remove all your current credentials for the
host(s) you are targeting. E.g. for GitHub, search for github.com
Internet Passwords.</p></li>
<li><p>Then add the credential that you want to use for "generic access".
This is the credential that will be used for URLs without user
names. The user name for this credential does not matter, but you
can choose something descriptive, e.g. "token", or "generic".</p></li>
<li><p>Configure git to use this username by default. E.g. if you chose
"generic", then run</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.username generic</span></code></pre><p></p></div></li>
<li><p>Add all the other credentials, with appropriate user names. These
are the user names that you need to put in the URLs for the
repositories or operations you want to use them for. (GitHub does
not actually use the user names if the password is a PAT, but they
are used to look up the correct token in the credential store.)</p></li>
</ol></div>

<div class="section">
<h4 id="windows-with-git-or-later">Windows with git 2.29.0 or later<a class="anchor" aria-label="anchor" href="#windows-with-git-or-later"></a></h4>

<ol><li><p>We suggest that you update to the latest git version, but at
least 2.29.0, and use the <code>manager-core</code> helper which is now default.
If you installed <code>manager-core</code> separately from git, we suggest that
you remove it, because it might cause confusion as to which helper is
actually used.</p></li>
<li><p>Remove all current credentials first, for the host you are targeting.
You can do this in 'Credential Manager' or <code><a href="gitcreds_list.html">gitcreds::gitcreds_list()</a></code>
to find them and 'Credential Manager' or the oskeyring package to
remove them. You can also use the oskeyring package to back up the
tokens and passwords.</p></li>
<li><p>Then add the credential that you want to use for "generic access".
This is the credential that will be used for URLs without user names.
The user name for this credential does not matter, but you can choose
something descriptive, e.g. "PersonalAccessToken", "token", or
"generic".</p></li>
<li><p>Configure git to use this username by default. E.g. if you chose
"generic", then run</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.username generic</span></code></pre><p></p></div></li>
<li><p>Add all the other credentials, with appropriate user names.
These are the user names that you need to put in the URLs for the
repositories or operations you want to use them for. (GitHub does
not actually use the user names if the password is a PAT, but they
are used to look up the correct token from the credential store.)</p></li>
</ol></div>

<div class="section">
<h4 id="windows-with-older-git-versions-and-before">Windows with older git versions, 2.28.0 and before<a class="anchor" aria-label="anchor" href="#windows-with-older-git-versions-and-before"></a></h4>

<div class="section">
<h5 id="a-single-github-account">A single GitHub account<a class="anchor" aria-label="anchor" href="#a-single-github-account"></a></h5>


<p>If you only need to manage a single github.com credential, together with
possibly multiple credentials to other hosts (including GitHub
Enterprise hosts), then you can use the default <code>manager</code> helper, and
get away with the default auto-detected GCM authority setting.</p>
<p>In this case, you can add your github.com credential with an arbitrary
user name, and for each other host you can configure a default user
name, and/or include user names in the URLs to these hosts. This is how
to set a default user name for a host called <code>https://example.com</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.https<span class="sc">:</span><span class="er">//</span>example.com.username myusername</span></code></pre><p></p></div>
</div>

<div class="section">
<h5 id="multiple-github-credentials">Multiple GitHub credentials<a class="anchor" aria-label="anchor" href="#multiple-github-credentials"></a></h5>


<p>If you need to manage multiple github.com credentials, then you can
still use the <code>manager</code> helper, but you need to change the GCM authority
by setting an option or an environment variable, see
<a href="https://github.com/microsoft/Git-Credential-Manager-for-Windows/blob/master/Docs/Configuration.md#authority." class="external-link">https://github.com/microsoft/Git-Credential-Manager-for-Windows/blob/master/Docs/Configuration.md#authority.</a></p>
<p>This is how to change GCM authority in the config:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.authority Basic</span></code></pre><p></p></div>
<p>You can also change it only for github.com:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.github.com.authority Basic</span></code></pre><p></p></div>
<p>Then you can configure a default user name, this will be used for URLs
without a user name:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>git config <span class="sc">--</span>global credential.username generic</span></code></pre><p></p></div>
<p>Now you can add you credentials, the default one with the "generic" user
name, and all the others with their specific user and host names.</p>
<p>Alternatively, you can install a newer version of Git Credential Manager
Core (GCM Core), at least version 2.0.252-beta, and use the
<code>manager-core</code> helper. You'll potentially need to delete the older
<code>manager-core</code> helper that came with git itself. With the newer version
of GCM Core, you can use the same method as for newer git versions, see
above.</p>
</div>


</div>


</div>

<div class="section">
<h3 id="multiple-credential-helpers">Multiple credential helpers<a class="anchor" aria-label="anchor" href="#multiple-credential-helpers"></a></h3>


<p>It is possible to configure multiple credential helpers. If multiple
helpers are configured for a repository, then <code>gitcreds_get()</code> will
go over them until a credential is found. <code>gitcreds_set()</code> will try to
set the new credentials in <em>every</em> configured credential helper.</p>
<p>You can use <code>gitcreds_list_helpers()</code> to list all configured helpers.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">gitcreds_get</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gitcreds_get</span><span class="op">(</span><span class="st">"https://github.com"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gitcreds_get</span><span class="op">(</span><span class="st">"https://myuser@github.com/myorg/myrepo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

  </div></footer></body></html>

